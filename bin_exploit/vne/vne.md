# CTF Write-Up: [VNE][Binary Exploitation]

## Description
> We've got a binary that can list directories as root, try it out !!
Additional details will be available after launching your challenge instance.

## Flag
The flag you obtained after solving the challenge. (e.g., `picoCTF{Power_t0_man!pul4t3_3nv_1670f174}`)

## Difficulty
- **Difficulty Level:** medium

## Write-Up

### Step 1: [Preparatory Phase]
The user upon logging onto the shell is placed into a directory with a `bin` binary file. Upon running it, it states that the `SECRET DIR` environment variable is not set. This clues me into using the binary to investigate other 'secret' directories which I do not have privileges to access. 

![alt text](images/image.png)
> The root directory seemed like the most probable target
### Step 2: [Attack Phase]

I looked up how to set environment variables on Google as I forgot from previous courses unfortunately. In Linux/Unix machines the command is usually `export <name>=<value>`. In this case I first set the environment variable to the `root` relative to the position of the binary. It did not work.
![alt text](images/image.png)

I then switched to just doing `export SECRET_DIR=/root` and it gave me promising output. I assumed what the program did was simply run `ls <file-name>`. Therefore a promising attack would be to inject a `cat` command to print out the contents of the `flag.txt` file.
![alt text](images/image-1.png)

### Final Solution/Payload
![alt text](images/image-2.png)

## Lessons Learned
A rather trivial lesson learnt was connecting to via `ssh` requires the `-p` flag prior to entering the port number. I was simply writing `ssh <username> <host>:<port>` which was giving me `ssh: Could not resolve hostname saturn.picoctf.net:51113: Name or service not known` errors. 

## References
- https://www.geeksforgeeks.org/ssh-command-in-linux-with-examples/
- https://medium.com/chingu/an-introduction-to-environment-variables-and-how-to-use-them-f602f66d15fa

